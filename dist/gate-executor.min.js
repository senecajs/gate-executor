!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).GateExecutor=t()}}((function(){var t={exports:{}};return function(e){!function(n){"object"==typeof t.exports?t.exports=n():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).GateExecutor=n()}((function(){var t={exports:{}};return function(e){!function(n){"object"==typeof t.exports?t.exports=n():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).GateExecutor=n()}((function(){var t={exports:{}};return function(e){!function(n){"object"==typeof t.exports?t.exports=n():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).GateExecutor=n()}((function(){var t,e,n,o,i=(t=function(t,e){(function(t,n){var o=u.nextTick,i=(Function.prototype.apply,Array.prototype.slice),r={},f=0;function l(t,e){this._id=t,this._clearFn=e}l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},e.setImmediate="function"==typeof t?t:function(t){var n=f++,u=!(arguments.length<2)&&i.call(arguments,1);return r[n]=!0,o((function(){r[n]&&(u?t.apply(null,u):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof n?n:function(t){delete r[t]}}).call(this,i({}).setImmediate,i({}).clearImmediate)},function(n){return e||t(e={exports:{},parent:n},e.exports),e.exports}),r={},u={},f=u={};function l(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===l||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:l}catch(e){n=l}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var s,d=[],p=!1,h=-1;function y(){p&&s&&(p=!1,s.length?d=s.concat(d):h=-1,d.length&&m())}function m(){if(!p){var t=a(y);p=!0;for(var n=d.length;n;){for(s=d,d=[];++h<n;)s&&s[h].run();h=-1,n=d.length}s=null,p=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function w(t,e){this.fun=t,this.array=e}function g(){}f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new w(t,e)),1!==d.length||p||a(m)},w.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=g,f.addListener=g,f.once=g,f.off=g,f.removeListener=g,f.removeAllListeners=g,f.emit=g,f.prependListener=g,f.prependOnceListener=g,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0};var v={};return function(t){"use strict";function e(n,o){var i=this;r("object"==typeof n),r("number"==typeof o),i.id=++o,i.options=n;var u=[],f={lookup:{},history:[]},l=[],c={work_counter:0,gate:!1,running:!1,clear:null,firstclear:null,tm_in:null};function a(){if(c.running){i.isclear()||c.tm_in||(c.tm_in=setInterval(d,n.interval));do{var t=!1,e=null;c.gate||(e=u.shift()),e&&(r("object"==typeof e),r("string"==typeof e.id),r("function"==typeof e.fn),f.lookup[e.id]=e,f.history.push(e),c.gate=e.gate,e.start=Date.now(),e.callback=s(e),l.push(e),e.fn(e.callback),t=!0)}while(t)}}function s(e){return function(){if(!e.done){for(e.done=!0,delete f.lookup[e.id];f.history[0]&&f.history[0].done;)f.history.shift();for(;l[0]&&l[0].done;)l.shift();if(e.gate&&(c.gate=!1),0===u.length&&0===f.history.length){if(clearInterval(c.tm_in),c.tm_in=null,c.firstclear){var n=c.firstclear;c.firstclear=null,n()}c.clear&&c.clear()}t(a)}}}function d(){for(var t=Date.now(),e=null,n=0;n<l.length;++n)!(e=l[n]).gate&&!e.done&&e.tm<t-e.start&&(e.ontm&&e.ontm(e.tm,e.start,t),e.callback())}i.start=function(e){return r(null==e||"function"==typeof e),t((function(){c.running=!0,e&&(c.firstclear=e),a()})),i},i.pause=function(){c.running=!1},i.clear=function(t){return r("function"==typeof t),c.clear=t,i},i.isclear=function(){return 0===u.length&&0===f.history.length},i.add=function(e){return r("object"==typeof e),r("function"==typeof e.fn),r(null==e.id||"string"==typeof e.id),r(null==e.tm||"number"==typeof e.tm),r(null==e.dn||"string"==typeof e.dn),c.work_counter+=1,e.id=e.id||""+c.work_counter,e.ge=i.id,e.tm=null==e.tm?n.timeout:e.tm,e.dn=e.dn||e.fn.name||""+Date.now(),e.ctxt={},u.push(e),c.running&&t(a),i},i.gate=function(){var t=new e(n,o);return i.add({gate:t,fn:function(e){t.start(e)}}),t},i.state=function(){for(var t=[],e=0;e<f.history.length;++e){var n=f.history[e];n.done||t.push({s:"a",ge:n.ge,dn:n.dn,id:n.id})}for(var o=0;o<u.length;++o){var i=u[o];i.gate?t.push(i.gate.state()):t.push({s:"w",ge:i.ge,dn:i.dn,id:i.id})}return t.internal={qlen:u.length,hlen:f.history.length,klen:Object.keys(f.lookup).length,tlen:d.length},t}}r="function"==typeof r?r:function(){},v=function(t){return(t=t||{}).interval=null==t.interval?111:t.interval,t.timeout=null==t.timeout?2222:t.timeout,r("object"==typeof t),r("number"==typeof t.interval),r("number"==typeof t.timeout),r(0<t.interval),r(0<t.timeout),new e(t,0)}}.call(this,i({}).setImmediate),v}))}.call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),t=t.exports}))}.call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),t=t.exports}))}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),t=t.exports}));